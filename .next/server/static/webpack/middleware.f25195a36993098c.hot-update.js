"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("middleware",{

/***/ "(middleware)/./middleware.ts":
/*!***********************!*\
  !*** ./middleware.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/supabase-js */ \"(middleware)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n\n\nasync function middleware(req) {\n    const res = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    // Create a Supabase client for middleware\n    const supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_1__.createClient)(\"https://example.supabase.co\", \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJlc2V0bGluayIsInJvbGUiOiJhbm9uIiwiaWF0IjoxNjgwOTU1MzMxLCJleHAiOjE5OTY1MzEzMzF9.placeholder_key\");\n    // Get the current path\n    const path = req.nextUrl.pathname;\n    // Refresh session if expired - required for Server Components\n    await supabase.auth.getSession();\n    // Protected routes: dashboard, onboarding, settings, api routes\n    const protectedRoutes = [\n        '/dashboard',\n        '/onboarding',\n        '/api/create-subscription',\n        '/api/send-proof-email',\n        '/api/generate-run-sheet'\n    ];\n    // Check if current path starts with any protected route\n    const isProtectedRoute = protectedRoutes.some((route)=>path.startsWith(route));\n    if (isProtectedRoute) {\n        const { data: { session } } = await supabase.auth.getSession();\n        // If no session and on a protected route, redirect to login\n        if (!session) {\n            const redirectUrl = new URL('/login', req.url);\n            redirectUrl.searchParams.set('redirectTo', path);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(redirectUrl);\n        }\n    }\n    // Public routes that don't need auth\n    const publicRoutes = [\n        '/',\n        '/login',\n        '/register',\n        '/api/auth/callback'\n    ];\n    // Check if the current path is a public route\n    const isPublicRoute = publicRoutes.some((route)=>path === route);\n    // For routes that are not protected and not public, they might be store-specific routes\n    // like /[storeSlug]/[orderId]\n    if (!isProtectedRoute && !isPublicRoute && !path.startsWith('/_next') && !path.startsWith('/api/proofs')) {\n        // Check if it's a valid store route pattern (/storeSlug/orderId)\n        const segments = path.split('/').filter(Boolean);\n        if (segments.length === 2) {\n            const [storeSlug, orderId] = segments;\n            // Verify that the store exists\n            const { data: store, error } = await supabase.from('stores').select('id').eq('slug', storeSlug).single();\n            if (error || !store) {\n                // If store not found, redirect to 404\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL('/not-found', req.url));\n            }\n        }\n    }\n    return res;\n}\nconst config = {\n    // Skip middleware for static assets and api routes that don't need auth\n    matcher: [\n        '/((?!_next/static|_next/image|favicon.ico|.*\\\\.svg).*)'\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vbWlkZGxld2FyZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQW9EO0FBQ1Y7QUFJbkMsZUFBZUUsV0FBV0MsR0FBZ0I7SUFDL0MsTUFBTUMsTUFBTUgscURBQVlBLENBQUNJLElBQUk7SUFFN0IsMENBQTBDO0lBQzFDLE1BQU1DLFdBQVdOLG1FQUFZQSxDQUMzQk8sNkJBQW9DLEVBQ3BDQSx1S0FBeUM7SUFHM0MsdUJBQXVCO0lBQ3ZCLE1BQU1JLE9BQU9SLElBQUlTLE9BQU8sQ0FBQ0MsUUFBUTtJQUVqQyw4REFBOEQ7SUFDOUQsTUFBTVAsU0FBU1EsSUFBSSxDQUFDQyxVQUFVO0lBRTlCLGdFQUFnRTtJQUNoRSxNQUFNQyxrQkFBa0I7UUFDdEI7UUFDQTtRQUNBO1FBQ0E7UUFDQTtLQUNEO0lBRUQsd0RBQXdEO0lBQ3hELE1BQU1DLG1CQUFtQkQsZ0JBQWdCRSxJQUFJLENBQUNDLENBQUFBLFFBQVNSLEtBQUtTLFVBQVUsQ0FBQ0Q7SUFFdkUsSUFBSUYsa0JBQWtCO1FBQ3BCLE1BQU0sRUFBRUksTUFBTSxFQUFFQyxPQUFPLEVBQUUsRUFBRSxHQUFHLE1BQU1oQixTQUFTUSxJQUFJLENBQUNDLFVBQVU7UUFFNUQsNERBQTREO1FBQzVELElBQUksQ0FBQ08sU0FBUztZQUNaLE1BQU1DLGNBQWMsSUFBSUMsSUFBSSxVQUFVckIsSUFBSXNCLEdBQUc7WUFDN0NGLFlBQVlHLFlBQVksQ0FBQ0MsR0FBRyxDQUFDLGNBQWNoQjtZQUMzQyxPQUFPVixxREFBWUEsQ0FBQzJCLFFBQVEsQ0FBQ0w7UUFDL0I7SUFDRjtJQUVBLHFDQUFxQztJQUNyQyxNQUFNTSxlQUFlO1FBQUM7UUFBSztRQUFVO1FBQWE7S0FBcUI7SUFFdkUsOENBQThDO0lBQzlDLE1BQU1DLGdCQUFnQkQsYUFBYVgsSUFBSSxDQUFDQyxDQUFBQSxRQUFTUixTQUFTUTtJQUUxRCx3RkFBd0Y7SUFDeEYsOEJBQThCO0lBQzlCLElBQUksQ0FBQ0Ysb0JBQW9CLENBQUNhLGlCQUFpQixDQUFDbkIsS0FBS1MsVUFBVSxDQUFDLGFBQWEsQ0FBQ1QsS0FBS1MsVUFBVSxDQUFDLGdCQUFnQjtRQUN4RyxpRUFBaUU7UUFDakUsTUFBTVcsV0FBV3BCLEtBQUtxQixLQUFLLENBQUMsS0FBS0MsTUFBTSxDQUFDQztRQUV4QyxJQUFJSCxTQUFTSSxNQUFNLEtBQUssR0FBRztZQUN6QixNQUFNLENBQUNDLFdBQVdDLFFBQVEsR0FBR047WUFFN0IsK0JBQStCO1lBQy9CLE1BQU0sRUFBRVYsTUFBTWlCLEtBQUssRUFBRUMsS0FBSyxFQUFFLEdBQUcsTUFBTWpDLFNBQ2xDa0MsSUFBSSxDQUFDLFVBQ0xDLE1BQU0sQ0FBQyxNQUNQQyxFQUFFLENBQUMsUUFBUU4sV0FDWE8sTUFBTTtZQUVULElBQUlKLFNBQVMsQ0FBQ0QsT0FBTztnQkFDbkIsc0NBQXNDO2dCQUN0QyxPQUFPckMscURBQVlBLENBQUMyQixRQUFRLENBQUMsSUFBSUosSUFBSSxjQUFjckIsSUFBSXNCLEdBQUc7WUFDNUQ7UUFDRjtJQUNGO0lBRUEsT0FBT3JCO0FBQ1Q7QUFFTyxNQUFNd0MsU0FBUztJQUNwQix3RUFBd0U7SUFDeEVDLFNBQVM7UUFDUDtLQUNEO0FBQ0gsRUFBQyIsInNvdXJjZXMiOlsiL2hvbWUvcnVubmVyL3dvcmtzcGFjZS9taWRkbGV3YXJlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcydcbmltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJ1xuaW1wb3J0IHR5cGUgeyBOZXh0UmVxdWVzdCB9IGZyb20gJ25leHQvc2VydmVyJ1xuaW1wb3J0IHR5cGUgeyBEYXRhYmFzZSB9IGZyb20gJy4vbGliL3N1cGFiYXNlJ1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbWlkZGxld2FyZShyZXE6IE5leHRSZXF1ZXN0KSB7XG4gIGNvbnN0IHJlcyA9IE5leHRSZXNwb25zZS5uZXh0KClcbiAgXG4gIC8vIENyZWF0ZSBhIFN1cGFiYXNlIGNsaWVudCBmb3IgbWlkZGxld2FyZVxuICBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZUNsaWVudDxEYXRhYmFzZT4oXG4gICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMISxcbiAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSFcbiAgKVxuICBcbiAgLy8gR2V0IHRoZSBjdXJyZW50IHBhdGhcbiAgY29uc3QgcGF0aCA9IHJlcS5uZXh0VXJsLnBhdGhuYW1lXG4gIFxuICAvLyBSZWZyZXNoIHNlc3Npb24gaWYgZXhwaXJlZCAtIHJlcXVpcmVkIGZvciBTZXJ2ZXIgQ29tcG9uZW50c1xuICBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFNlc3Npb24oKVxuICBcbiAgLy8gUHJvdGVjdGVkIHJvdXRlczogZGFzaGJvYXJkLCBvbmJvYXJkaW5nLCBzZXR0aW5ncywgYXBpIHJvdXRlc1xuICBjb25zdCBwcm90ZWN0ZWRSb3V0ZXMgPSBbXG4gICAgJy9kYXNoYm9hcmQnLFxuICAgICcvb25ib2FyZGluZycsXG4gICAgJy9hcGkvY3JlYXRlLXN1YnNjcmlwdGlvbicsXG4gICAgJy9hcGkvc2VuZC1wcm9vZi1lbWFpbCcsXG4gICAgJy9hcGkvZ2VuZXJhdGUtcnVuLXNoZWV0JyxcbiAgXVxuICBcbiAgLy8gQ2hlY2sgaWYgY3VycmVudCBwYXRoIHN0YXJ0cyB3aXRoIGFueSBwcm90ZWN0ZWQgcm91dGVcbiAgY29uc3QgaXNQcm90ZWN0ZWRSb3V0ZSA9IHByb3RlY3RlZFJvdXRlcy5zb21lKHJvdXRlID0+IHBhdGguc3RhcnRzV2l0aChyb3V0ZSkpXG4gIFxuICBpZiAoaXNQcm90ZWN0ZWRSb3V0ZSkge1xuICAgIGNvbnN0IHsgZGF0YTogeyBzZXNzaW9uIH0gfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0U2Vzc2lvbigpXG4gICAgXG4gICAgLy8gSWYgbm8gc2Vzc2lvbiBhbmQgb24gYSBwcm90ZWN0ZWQgcm91dGUsIHJlZGlyZWN0IHRvIGxvZ2luXG4gICAgaWYgKCFzZXNzaW9uKSB7XG4gICAgICBjb25zdCByZWRpcmVjdFVybCA9IG5ldyBVUkwoJy9sb2dpbicsIHJlcS51cmwpXG4gICAgICByZWRpcmVjdFVybC5zZWFyY2hQYXJhbXMuc2V0KCdyZWRpcmVjdFRvJywgcGF0aClcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QocmVkaXJlY3RVcmwpXG4gICAgfVxuICB9XG4gIFxuICAvLyBQdWJsaWMgcm91dGVzIHRoYXQgZG9uJ3QgbmVlZCBhdXRoXG4gIGNvbnN0IHB1YmxpY1JvdXRlcyA9IFsnLycsICcvbG9naW4nLCAnL3JlZ2lzdGVyJywgJy9hcGkvYXV0aC9jYWxsYmFjayddXG4gIFxuICAvLyBDaGVjayBpZiB0aGUgY3VycmVudCBwYXRoIGlzIGEgcHVibGljIHJvdXRlXG4gIGNvbnN0IGlzUHVibGljUm91dGUgPSBwdWJsaWNSb3V0ZXMuc29tZShyb3V0ZSA9PiBwYXRoID09PSByb3V0ZSlcbiAgXG4gIC8vIEZvciByb3V0ZXMgdGhhdCBhcmUgbm90IHByb3RlY3RlZCBhbmQgbm90IHB1YmxpYywgdGhleSBtaWdodCBiZSBzdG9yZS1zcGVjaWZpYyByb3V0ZXNcbiAgLy8gbGlrZSAvW3N0b3JlU2x1Z10vW29yZGVySWRdXG4gIGlmICghaXNQcm90ZWN0ZWRSb3V0ZSAmJiAhaXNQdWJsaWNSb3V0ZSAmJiAhcGF0aC5zdGFydHNXaXRoKCcvX25leHQnKSAmJiAhcGF0aC5zdGFydHNXaXRoKCcvYXBpL3Byb29mcycpKSB7XG4gICAgLy8gQ2hlY2sgaWYgaXQncyBhIHZhbGlkIHN0b3JlIHJvdXRlIHBhdHRlcm4gKC9zdG9yZVNsdWcvb3JkZXJJZClcbiAgICBjb25zdCBzZWdtZW50cyA9IHBhdGguc3BsaXQoJy8nKS5maWx0ZXIoQm9vbGVhbilcbiAgICBcbiAgICBpZiAoc2VnbWVudHMubGVuZ3RoID09PSAyKSB7XG4gICAgICBjb25zdCBbc3RvcmVTbHVnLCBvcmRlcklkXSA9IHNlZ21lbnRzXG4gICAgICBcbiAgICAgIC8vIFZlcmlmeSB0aGF0IHRoZSBzdG9yZSBleGlzdHNcbiAgICAgIGNvbnN0IHsgZGF0YTogc3RvcmUsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnc3RvcmVzJylcbiAgICAgICAgLnNlbGVjdCgnaWQnKVxuICAgICAgICAuZXEoJ3NsdWcnLCBzdG9yZVNsdWcpXG4gICAgICAgIC5zaW5nbGUoKVxuICAgICAgXG4gICAgICBpZiAoZXJyb3IgfHwgIXN0b3JlKSB7XG4gICAgICAgIC8vIElmIHN0b3JlIG5vdCBmb3VuZCwgcmVkaXJlY3QgdG8gNDA0XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTCgnL25vdC1mb3VuZCcsIHJlcS51cmwpKVxuICAgICAgfVxuICAgIH1cbiAgfVxuICBcbiAgcmV0dXJuIHJlc1xufVxuXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xuICAvLyBTa2lwIG1pZGRsZXdhcmUgZm9yIHN0YXRpYyBhc3NldHMgYW5kIGFwaSByb3V0ZXMgdGhhdCBkb24ndCBuZWVkIGF1dGhcbiAgbWF0Y2hlcjogW1xuICAgICcvKCg/IV9uZXh0L3N0YXRpY3xfbmV4dC9pbWFnZXxmYXZpY29uLmljb3wuKlxcXFwuc3ZnKS4qKScsXG4gIF0sXG59XG4iXSwibmFtZXMiOlsiY3JlYXRlQ2xpZW50IiwiTmV4dFJlc3BvbnNlIiwibWlkZGxld2FyZSIsInJlcSIsInJlcyIsIm5leHQiLCJzdXBhYmFzZSIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9BTk9OX0tFWSIsInBhdGgiLCJuZXh0VXJsIiwicGF0aG5hbWUiLCJhdXRoIiwiZ2V0U2Vzc2lvbiIsInByb3RlY3RlZFJvdXRlcyIsImlzUHJvdGVjdGVkUm91dGUiLCJzb21lIiwicm91dGUiLCJzdGFydHNXaXRoIiwiZGF0YSIsInNlc3Npb24iLCJyZWRpcmVjdFVybCIsIlVSTCIsInVybCIsInNlYXJjaFBhcmFtcyIsInNldCIsInJlZGlyZWN0IiwicHVibGljUm91dGVzIiwiaXNQdWJsaWNSb3V0ZSIsInNlZ21lbnRzIiwic3BsaXQiLCJmaWx0ZXIiLCJCb29sZWFuIiwibGVuZ3RoIiwic3RvcmVTbHVnIiwib3JkZXJJZCIsInN0b3JlIiwiZXJyb3IiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJzaW5nbGUiLCJjb25maWciLCJtYXRjaGVyIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(middleware)/./middleware.ts\n");

/***/ })

});